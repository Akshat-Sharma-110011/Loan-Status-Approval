<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug Console - Loan Approval Predictor</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <div class="app-container debug-app">
        <header>
            <div class="logo">
                <i class="fas fa-chart-line"></i>
                <h1>Loan Approval Predictor</h1>
            </div>
            <nav>
                <ul>
                    <li><a href="/"><i class="fas fa-home"></i> Home</a></li>
                    <li><a href="/metrics" target="_blank"><i class="fas fa-chart-bar"></i> Metrics</a></li>
                    <li><a href="#" class="active"><i class="fas fa-bug"></i> Debug Console</a></li>
                </ul>
            </nav>
        </header>

        <main class="debug-main">
            <section class="debug-controls">
                <div class="card">
                    <div class="card-header">
                        <h3><i class="fas fa-tools"></i> Debugging Tools</h3>
                    </div>
                    <div class="card-body">
                        <div class="control-group">
                            <button id="refresh-logs" class="btn btn-primary"><i class="fas fa-sync-alt"></i> Refresh Logs</button>
                            <button id="clear-logs" class="btn btn-danger"><i class="fas fa-trash-alt"></i> Clear Logs</button>
                            <div class="log-filter">
                                <label for="log-level">Filter by level:</label>
                                <select id="log-level">
                                    <option value="ALL">All Levels</option>
                                    <option value="INFO">INFO</option>
                                    <option value="WARNING">WARNING</option>
                                    <option value="ERROR">ERROR</option>
                                    <option value="CRITICAL">CRITICAL</option>
                                </select>
                            </div>
                            <div class="search-logs">
                                <input type="text" id="log-search" placeholder="Search logs...">
                                <button class="btn btn-secondary"><i class="fas fa-search"></i></button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <section class="debug-console">
                <div class="card">
                    <div class="card-header">
                        <h3><i class="fas fa-terminal"></i> Log Console</h3>
                    </div>
                    <div class="card-body">
                        <div class="console-container">
                            <div id="log-output" class="log-output">
                                <div class="log-entry log-info">
                                    <span class="log-timestamp">2025-05-07 10:15:23</span>
                                    <span class="log-level">INFO</span>
                                    <span class="log-message">Loading preprocessing pipeline...</span>
                                </div>
                                <div class="log-entry log-info">
                                    <span class="log-timestamp">2025-05-07 10:15:24</span>
                                    <span class="log-level">INFO</span>
                                    <span class="log-message">Loading CatBoost model...</span>
                                </div>
                                <div class="log-entry log-info">
                                    <span class="log-timestamp">2025-05-07 10:15:26</span>
                                    <span class="log-level">INFO</span>
                                    <span class="log-message">Model and pipeline loaded successfully</span>
                                </div>
                                <div class="log-entry log-info">
                                    <span class="log-timestamp">2025-05-07 10:15:26</span>
                                    <span class="log-level">INFO</span>
                                    <span class="log-message">Model features: ['person_age', 'person_gender', 'person_education', 'person_income', 'person_emp_exp', 'person_home_ownership', 'loan_amnt', 'loan_intent', 'loan_int_rate', 'loan_percent_income', 'cb_person_cred_hist_length', 'credit_score', 'previous_loan_defaults_on_file']</span>
                                </div>
                                <div class="log-entry log-info">
                                    <span class="log-timestamp">2025-05-07 10:17:42</span>
                                    <span class="log-level">INFO</span>
                                    <span class="log-message">Received input data:<br>{
                                        'person_age': 35,
                                        'person_gender': 'Male',
                                        'person_education': 'Bachelor',
                                        'person_income': 65000.0,
                                        'person_emp_exp': 8.0,
                                        'person_home_ownership': 'MORTGAGE',
                                        'loan_amnt': 15000.0,
                                        'loan_intent': 'PERSONAL',
                                        'loan_int_rate': 6.5,
                                        'loan_percent_income': 23.0,
                                        'cb_person_cred_hist_length': 12,
                                        'credit_score': 720,
                                        'previous_loan_defaults_on_file': 'No'
                                    }</span>
                                </div>
                                <div class="log-entry log-info">
                                    <span class="log-timestamp">2025-05-07 10:17:43</span>
                                    <span class="log-level">INFO</span>
                                    <span class="log-message">Transformed features:
                                    {'person_age': 35.0, 'person_income': 65000.0, 'person_emp_exp': 8.0, 'loan_amnt': 15000.0, 'loan_int_rate': 6.5, 'loan_percent_income': 23.0, 'cb_person_cred_hist_length': 12.0, 'credit_score': 720.0, 'person_gender_Female': 0.0, 'person_gender_Male': 1.0, 'person_gender_Other': 0.0, 'person_education_Bachelor': 1.0, 'person_education_High School': 0.0, 'person_education_Master': 0.0, 'person_education_PhD': 0.0, 'person_education_Other': 0.0, 'person_home_ownership_MORTGAGE': 1.0, 'person_home_ownership_OTHER': 0.0, 'person_home_ownership_OWN': 0.0, 'person_home_ownership_RENT': 0.0, 'loan_intent_BUSINESS': 0.0, 'loan_intent_DEBT_CONSOLIDATION': 0.0, 'loan_intent_EDUCATION': 0.0, 'loan_intent_HOME_IMPROVEMENT': 0.0, 'loan_intent_MEDICAL': 0.0, 'loan_intent_OTHER': 0.0, 'loan_intent_PERSONAL': 1.0, 'previous_loan_defaults_on_file_No': 1.0, 'previous_loan_defaults_on_file_Yes': 0.0}</span>
                                </div>
                                <div class="log-entry log-info">
                                    <span class="log-timestamp">2025-05-07 10:17:44</span>
                                    <span class="log-level">INFO</span>
                                    <span class="log-message">Prediction: approved (86.23%)</span>
                                </div>
                                <div class="log-entry log-warning">
                                    <span class="log-timestamp">2025-05-07 10:25:18</span>
                                    <span class="log-level">WARNING</span>
                                    <span class="log-message">Received unusual values in input: credit_score = 950 (exceeds typical maximum)</span>
                                </div>
                                <div class="log-entry log-error">
                                    <span class="log-timestamp">2025-05-07 10:32:59</span>
                                    <span class="log-level">ERROR</span>
                                    <span class="log-message">Prediction error: Invalid input type for person_age: expected int, got str</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <section class="debug-model-info">
                <div class="card">
                    <div class="card-header">
                        <h3><i class="fas fa-info-circle"></i> Model Information</h3>
                    </div>
                    <div class="card-body">
                        <div class="info-grid">
                            <div class="info-item">
                                <span class="info-label">Model Type:</span>
                                <span class="info-value">CatBoost Classifier</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Model Path:</span>
                                <span class="info-value">./models/model/model.cbm</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Preprocessor Path:</span>
                                <span class="info-value">./models/preprocessor/preprocessing_pipeline.pkl</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Feature Count:</span>
                                <span class="info-value">13 original, 29 transformed</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Experiment Name:</span>
                                <span class="info-value">CatBoost Optimizer</span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Debug Mode:</span>
                                <span class="info-value">Enabled</span>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <section class="debug-metrics">
                <div class="card">
                    <div class="card-header">
                        <h3><i class="fas fa-chart-bar"></i> Live Metrics</h3>
                    </div>
                    <div class="card-body">
                        <div class="metrics-grid">
                            <div class="metric-item">
                                <h4>Request Count</h4>
                                <div class="metric-value">152</div>
                                <div class="metric-chart">
                                    <div class="bar-graph">
                                        <div class="bar" style="height: 60%;" title="GET: 89"></div>
                                        <div class="bar" style="height: 40%;" title="POST: 63"></div>
                                    </div>
                                    <div class="bar-labels">
                                        <span>GET</span>
                                        <span>POST</span>
                                    </div>
                                </div>
                            </div>
                            <div class="metric-item">
                                <h4>Predictions</h4>
                                <div class="metric-value">63</div>
                                <div class="metric-chart">
                                    <div class="pie-chart">
                                        <div class="pie-segment approved" style="--percentage: 71%;"></div>
                                    </div>
                                    <div class="pie-legend">
                                        <div class="legend-item">
                                            <span class="legend-color approved"></span>
                                            <span>Approved: 71%</span>
                                        </div>
                                        <div class="legend-item">
                                            <span class="legend-color rejected"></span>
                                            <span>Rejected: 29%</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="metric-item">
                                <h4>Response Time</h4>
                                <div class="metric-value">218ms</div>
                                <div class="metric-chart">
                                    <div class="line-placeholder">
                                        <img src="/api/placeholder/300/100" alt="Response time graph">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <footer>
            <div class="footer-content">
                <div class="footer-logo">
                    <i class="fas fa-chart-line"></i>
                    <span>Loan Approval Predictor</span>
                </div>
                <div class="footer-links">
                    <a href="/">Home</a>
                    <a href="/metrics">Metrics</a>
                </div>
                <div class="footer-copyright">
                    <p>&copy; 2025 Loan Approval Predictor. All rights reserved.</p>
                </div>
            </div>
        </footer>
    </div>

    <script>
        // Toggle log entries based on level filter
        document.getElementById('log-level').addEventListener('change', function() {
            const level = this.value;
            const logEntries = document.querySelectorAll('.log-entry');

            logEntries.forEach(entry => {
                if (level === 'ALL' || entry.classList.contains('log-' + level.toLowerCase())) {
                    entry.style.display = 'block';
                } else {
                    entry.style.display = 'none';
                }
            });
        });

        // Search functionality
        document.getElementById('log-search').addEventListener('input', function() {
            const searchText = this.value.toLowerCase();
            const logEntries = document.querySelectorAll('.log-entry');

            logEntries.forEach(entry => {
                const messageText = entry.querySelector('.log-message').textContent.toLowerCase();
                if (messageText.includes(searchText)) {
                    entry.style.display = 'block';
                } else {
                    entry.style.display = 'none';
                }
            });
        });

        // Clear logs functionality
        document.getElementById('clear-logs').addEventListener('click', function() {
            if (confirm('Are you sure you want to clear all logs?')) {
                document.getElementById('log-output').innerHTML =
                    '<div class="log-entry log-info">' +
                    '<span class="log-timestamp">' + new Date().toLocaleString() + '</span>' +
                    '<span class="log-level">INFO</span>' +
                    '<span class="log-message">Logs cleared by user</span>' +
                    '</div>';
            }
        });

        // Refresh logs functionality (simulated)
        document.getElementById('refresh-logs').addEventListener('click', function() {
            this.classList.add('rotating');
            setTimeout(() => {
                this.classList.remove('rotating');
                alert('Logs refreshed');
            }, 1000);
        });
    </script>
</body>
</html>